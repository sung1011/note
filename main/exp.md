# 经验

## crontab

- 集群分布式锁竞争压力是否过大
- 扩容缩容等机器变更时，是否影响crontab执行
- 定时任务测试脚本(检测缩容后是否正确地全区执行)
- 输出必须重定向

## code

- 关联数据。如： 英雄上标记穿着啥装备，装备上标记着是否被穿。
- 各种运营log，需要有独立的命名，以便区分(不要都叫snap，datalog)。
- 充分考虑跨服合服需求。
- 刚上线的一段时间，注意db实例放到不同机器。(replica分片(没用mongos)机制)
- 关注数据库连接数与数据库连接池的数量匹配。（如: 每台物理机的php-fpm worker太多，连接数也会很多）
- db数据提前考虑数据过期(如活动数据)
- 分包处理比batch处理更对log友好
- 分级记录bug list
- 透明大页Huge page
- 排行榜的vip等级（或充值数）纠察高排名的非R作弊嫌疑

## 上线前准备

- 压力测试
- 是否需要新增机器
- 是否需要机器特殊配置
- 是否准备好运维脚本
- 是否需要做初始化工作
- 环境部署后检查

## QA

- 如何切维护踢人
- 登录其他设备如何踢人
- 如何统计在线时间

## issues

- 海外登录异常，如何复现和定位
