# snowflake 雪花算法

```js
    0 00000000000000000000000000000000000000000 00000 00000 000000000000

  1bit                  41bit                   5bit    5bit    12bit
  符号位                 时间戳                 数据中心id 机器id   序列号
```

| 范围  | 长度 | 作用               |
| ----- | ---- | ------------------ |
| 0-0   | 1    | 不使用 0正/1负     |
| 1-41  | 41   | 毫秒级时间戳       |
| 42-46 | 5    | 数据中心标识符     |
| 47-51 | 5    | 机器标识符         |
| 52-63 | 12   | 序号 最多2^12=4096 |

## 场景

    分布式全局唯一ID

## 特征

    高性能 不依赖数据库, 完全在内存中生成
    高吞吐 每秒能生成数百万自增ID
    ID自增 存入数据库中 索引效率高

## 缺点

    依赖系统时间, 如果系统时间被回调或改变, 课鞥呢造成ID冲突或者重复

## 实战

- mybatis
- mongodb